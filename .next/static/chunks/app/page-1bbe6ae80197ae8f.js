(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{41218:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>tS});var a=s(95155),r=s(12115),n=s(37586),o=s(39867),i=s(65229),l=s(14285),c=s(39068),d=s(59e3),m=s(18085),u=s(32467),h=s(83101),x=s(64269);let p=(0,h.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),f=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:o=!1,...i}=e,l=o?u.DX:"button";return(0,a.jsx)(l,{className:(0,x.cn)(p({variant:r,size:n,className:s})),ref:t,...i})});f.displayName="Button";let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,x.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});g.displayName="Textarea";var y=s(59034);let v=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(y.bL,{ref:t,className:(0,x.cn)("relative overflow-hidden",s),...n,children:[(0,a.jsx)(y.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(b,{}),(0,a.jsx)(y.OK,{})]})});v.displayName=y.bL.displayName;let b=r.forwardRef((e,t)=>{let{className:s,orientation:r="vertical",...n}=e;return(0,a.jsx)(y.VM,{ref:t,orientation:r,className:(0,x.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...n,children:(0,a.jsx)(y.lr,{className:"relative flex-1 rounded-full bg-border"})})});b.displayName=y.VM.displayName;var j=s(42196),N=s(89715),w=s(20508),C=s(93499),S=s(75426),k=s(25276),R=s(49745),A=s(64662),D=s(18720),_=s(6504),E=s(22133);let M=e=>{var t;let{message:s}=e,o="user"===s.role,[i,l]=(0,r.useState)(null),c=async()=>{try{await navigator.clipboard.writeText(s.content),D.oR.success("Message copied to clipboard")}catch(e){D.oR.error("Failed to copy message")}},d=e=>{i===e?(l(null),D.oR.info("".concat("up"===e?"Positive":"Negative"," feedback removed"))):(l(e),D.oR.success("Thank you for your ".concat("up"===e?"positive":"negative"," feedback!"))),console.log("Feedback updated:",{messageId:s.id,type:i===e?null:e})};return(0,a.jsxs)("div",{className:"message-fade-in flex items-start gap-4 ".concat(o?"flex-row-reverse":""," group"),children:[(0,a.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full transition-all ".concat(o?"bg-primary shadow-md ring-2 ring-primary/20":"bg-gradient-to-br from-muted to-muted/60 border border-border/50 shadow-sm"),children:o?(0,a.jsx)(w.A,{className:"h-5 w-5 text-primary-foreground"}):(0,a.jsx)(n.A,{className:"h-5 w-5 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsxs)("div",{className:"rounded-2xl px-5 py-3.5 shadow-sm transition-all ".concat(o?"bg-primary text-primary-foreground ml-auto max-w-[75%] hover:shadow-md":"bg-muted/80 text-foreground max-w-[85%] border border-border/40 hover:bg-muted hover:border-border/60"),children:[(null==(t=s.files)?void 0:t.length)>0&&(0,a.jsx)("div",{className:"mb-3 space-y-2",children:s.files.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 rounded-lg px-3 py-2 text-sm ".concat(o?"bg-primary-foreground/10 hover:bg-primary-foreground/20":"bg-background/60 hover:bg-background border border-border/30"),children:[e.preview?(0,a.jsx)("img",{src:e.preview,alt:e.name,className:"h-12 w-12 rounded object-cover border border-border/20"}):e.type.startsWith("image/")?(0,a.jsx)(j.A,{className:"h-4 w-4"}):(0,a.jsx)(N.A,{className:"h-4 w-4"}),(0,a.jsxs)("div",{className:"flex flex-col flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"truncate font-medium",children:e.name}),(0,a.jsx)("span",{className:"text-xs opacity-70",children:(e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]})(e.size)})]})]},t))}),(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:o?(0,a.jsx)("p",{className:"mb-0",children:s.content}):(0,a.jsx)(_.oz,{remarkPlugins:[E.A],components:{h1:e=>{let{children:t}=e;return(0,a.jsx)("h1",{className:"text-xl font-bold mb-2 mt-4 first:mt-0",children:t})},h2:e=>{let{children:t}=e;return(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 mt-3 first:mt-0",children:t})},h3:e=>{let{children:t}=e;return(0,a.jsx)("h3",{className:"text-base font-medium mb-1 mt-2 first:mt-0",children:t})},p:e=>{let{children:t}=e;return(0,a.jsx)("p",{className:"mb-2 last:mb-0",children:t})},ul:e=>{let{children:t}=e;return(0,a.jsx)("ul",{className:"list-disc list-inside mb-2 space-y-1",children:t})},ol:e=>{let{children:t}=e;return(0,a.jsx)("ol",{className:"list-decimal list-inside mb-2 space-y-1",children:t})},li:e=>{let{children:t}=e;return(0,a.jsx)("li",{className:"text-sm",children:t})},code:e=>{let{inline:t,children:s}=e;return t?(0,a.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded text-sm font-mono",children:s}):(0,a.jsx)("pre",{className:"bg-muted p-3 rounded-md overflow-x-auto mb-2",children:(0,a.jsx)("code",{className:"text-sm font-mono",children:s})})},blockquote:e=>{let{children:t}=e;return(0,a.jsx)("blockquote",{className:"border-l-4 border-muted-foreground/20 pl-4 italic mb-2",children:t})},table:e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"overflow-x-auto mb-2",children:(0,a.jsx)("table",{className:"min-w-full border-collapse border border-muted",children:t})})},th:e=>{let{children:t}=e;return(0,a.jsx)("th",{className:"border border-muted bg-muted/50 px-3 py-2 text-left font-medium",children:t})},td:e=>{let{children:t}=e;return(0,a.jsx)("td",{className:"border border-muted px-3 py-2",children:t})},strong:e=>{let{children:t}=e;return(0,a.jsx)("strong",{className:"font-semibold",children:t})},em:e=>{let{children:t}=e;return(0,a.jsx)("em",{className:"italic",children:t})}},children:s.content})})]}),s.citations&&s.citations.length>0&&(0,a.jsxs)("div",{className:"mt-3 rounded-lg border border-border/50 bg-muted/30 p-3 max-w-[85%]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-xs font-medium text-muted-foreground",children:"Sources"})]}),(0,a.jsx)("div",{className:"space-y-1.5",children:s.citations.map((e,t)=>(0,a.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-start gap-2 text-xs text-primary hover:text-primary/80 hover:underline transition-colors group",children:[(0,a.jsxs)("span",{className:"opacity-60 group-hover:opacity-100",children:["[",t+1,"]"]}),(0,a.jsx)("span",{className:"flex-1",children:e.title}),(0,a.jsx)(C.A,{className:"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]},t))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2.5 text-xs text-muted-foreground px-1 transition-colors ".concat(o?"justify-end":""),children:[o?"You":"GFMI Assistant","•",(0,A.GP)(s.timestamp,"h:mm a"),!o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:c,className:"h-6 w-6 p-0 opacity-60 hover:opacity-100",children:(0,a.jsx)(S.A,{className:"h-3 w-3"})}),(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:()=>d("up"),className:"h-6 w-6 p-0 ".concat("up"===i?"text-green-600":"opacity-60 hover:opacity-100"),children:(0,a.jsx)(k.A,{className:"h-3 w-3"})}),(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:()=>d("down"),className:"h-6 w-6 p-0 ".concat("down"===i?"text-red-600":"opacity-60 hover:opacity-100"),children:(0,a.jsx)(R.A,{className:"h-3 w-3"})})]})]})]})]})},F=e=>{let{datasetCount:t,onSuggestedQuestion:s}=e;return(0,a.jsx)("div",{className:"h-full overflow-y-auto custom-scrollbar",children:(0,a.jsxs)("div",{className:"flex min-h-full flex-col items-center justify-center text-center px-4 py-8",children:[(0,a.jsx)("div",{className:"mb-8 flex h-24 w-24 items-center justify-center rounded-full bg-muted transition-colors",children:(0,a.jsx)(n.A,{className:"h-12 w-12 text-muted-foreground"})}),(0,a.jsx)("h1",{className:"mb-4 text-3xl font-semibold text-foreground transition-colors",children:"Welcome to GFMI Assistant"}),(0,a.jsx)("p",{className:"mb-8 max-w-2xl text-lg text-muted-foreground transition-colors",children:"Use the filters on the left to narrow down your dataset, then ask questions to get insights from your data."}),(0,a.jsx)("div",{className:"mb-8 rounded-lg bg-muted px-6 py-3 text-sm transition-colors",children:(0,a.jsxs)("p",{className:"text-muted-foreground transition-colors",children:["Currently working with"," ",(0,a.jsxs)("span",{className:"font-semibold text-foreground transition-colors",children:[(t/1e3).toFixed(1),"K"]})," ","filtered datasets"]})}),(0,a.jsxs)("div",{className:"space-y-4 w-full max-w-2xl pb-8",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground transition-colors",children:"Try asking:"}),(0,a.jsx)("div",{className:"flex flex-col gap-3 sm:flex-row sm:justify-center sm:flex-wrap",children:["What are the key trends in this data?","Summarize the findings"].map((e,t)=>(0,a.jsxs)(f,{variant:"outline",onClick:()=>s(e),className:"min-w-[200px] transition-all hover:shadow-sm",children:['"',e,'"']},t))})]})]})})};function O(e,t){let[s,a]=(0,r.useState)(()=>{try{let s=window.localStorage.getItem(e);return s?JSON.parse(s):t}catch(s){return console.warn('Error reading localStorage key "'.concat(e,'":'),s),t}});return(0,r.useEffect)(()=>{let t=t=>{t.key===e&&t.newValue&&a(JSON.parse(t.newValue))};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e]),[s,t=>{try{let r=t instanceof Function?t(s):t;a(r),window.localStorage.setItem(e,JSON.stringify(r))}catch(t){console.warn('Error setting localStorage key "'.concat(e,'":'),t)}}]}var L=s(95736),T=s(27937),z=s(5917),I=s(99051);let P=L.bL,U=L.l9;L.YJ,L.ZL,L.Pb,L.z6,r.forwardRef((e,t)=>{let{className:s,inset:r,children:n,...o}=e;return(0,a.jsxs)(L.ZP,{ref:t,className:(0,x.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",r&&"pl-8",s),...o,children:[n,(0,a.jsx)(T.A,{className:"ml-auto h-4 w-4"})]})}).displayName=L.ZP.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(L.G5,{ref:t,className:(0,x.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=L.G5.displayName;let H=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...n}=e;return(0,a.jsx)(L.ZL,{children:(0,a.jsx)(L.UC,{ref:t,sideOffset:r,className:(0,x.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})})});H.displayName=L.UC.displayName;let q=r.forwardRef((e,t)=>{let{className:s,inset:r,...n}=e;return(0,a.jsx)(L.q7,{ref:t,className:(0,x.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",r&&"pl-8",s),...n})});q.displayName=L.q7.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:n,...o}=e;return(0,a.jsxs)(L.H_,{ref:t,className:(0,x.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",s),checked:n,...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(L.VF,{children:(0,a.jsx)(z.A,{className:"h-4 w-4"})})}),r]})}).displayName=L.H_.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(L.hN,{ref:t,className:(0,x.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(L.VF,{children:(0,a.jsx)(I.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=L.hN.displayName,r.forwardRef((e,t)=>{let{className:s,inset:r,...n}=e;return(0,a.jsx)(L.JU,{ref:t,className:(0,x.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...n})}).displayName=L.JU.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(L.wv,{ref:t,className:(0,x.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=L.wv.displayName;let W=()=>(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-muted to-muted/60 border border-border/50",children:(0,a.jsx)(n.A,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsx)("div",{className:"bg-muted/60 border border-border/30 rounded-2xl px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-muted-foreground/60 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-muted-foreground/60 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-muted-foreground/60 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,a.jsx)("span",{className:"ml-3 text-xs text-muted-foreground",children:"GFMI Assistant is thinking..."})]})})]});var B=s(66630),J=s(44309),K=s(59427),G=s(37494),V=s(50691),Q=s(48314),Y=s(46046),Z=s(89511);let X=Z.bL,$=Z.l9;Z.bm;let ee=Z.ZL,et=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(Z.hJ,{className:(0,x.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:t})});et.displayName=Z.hJ.displayName;let es=(0,h.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ea=r.forwardRef((e,t)=>{let{side:s="right",className:r,children:n,...o}=e;return(0,a.jsxs)(ee,{children:[(0,a.jsx)(et,{}),(0,a.jsxs)(Z.UC,{ref:t,className:(0,x.cn)(es({side:s}),r),...o,children:[n,(0,a.jsxs)(Z.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});ea.displayName=Z.UC.displayName;let er=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,x.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};er.displayName="SheetHeader";let en=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(Z.hE,{ref:t,className:(0,x.cn)("text-lg font-semibold text-foreground",s),...r})});en.displayName=Z.hE.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(Z.VY,{ref:t,className:(0,x.cn)("text-sm text-muted-foreground",s),...r})}).displayName=Z.VY.displayName;var eo=s(57268);let ei=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:n=!0,...o}=e;return(0,a.jsx)(eo.b,{ref:t,decorative:n,orientation:r,className:(0,x.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...o})});ei.displayName=eo.b.displayName;let el=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,x.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});el.displayName="Input";var ec=s(10489);let ed=(0,h.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),em=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ec.b,{ref:t,className:(0,x.cn)(ed(),s),...r})});em.displayName=ec.b.displayName;var eu=s(6191);let eh=e=>{let{filters:t,setFilters:s}=e,[n,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(""),[d,m]=(0,r.useState)(""),[u,h]=(0,r.useState)("");return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground",children:"Timeline"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-sidebar-foreground",children:"Date Range"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:["Last 30 days","Last 90 days","Last year"].map(e=>(0,a.jsx)(f,{variant:t.dateRange===e?"default":"outline",size:"sm",onClick:()=>{s({...t,dateRange:e,customDateRange:null}),o(!1)},className:"text-xs",children:e},e))}),t.savedCustomRanges&&t.savedCustomRanges.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:t.savedCustomRanges.map(e=>{var r;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(f,{variant:"Custom"===t.dateRange&&(null==(r=t.customDateRange)?void 0:r.id)===e.id?"default":"outline",size:"sm",onClick:()=>{s({...t,dateRange:"Custom",customDateRange:e})},className:"text-xs",children:e.label}),(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>(e=>{var a;let r=(t.savedCustomRanges||[]).filter(t=>t.id!==e);s({...t,savedCustomRanges:r,...(null==(a=t.customDateRange)?void 0:a.id)===e&&{dateRange:"",customDateRange:null}}),D.oR.success("Custom date range removed")})(e.id),children:(0,a.jsx)(i.A,{className:"h-3 w-3"})})]},e.id)})})]}),!n&&(0,a.jsxs)(f,{variant:"ghost",size:"sm",onClick:()=>o(!0),className:"w-full justify-start text-xs",children:[(0,a.jsx)(eu.A,{className:"mr-2 h-3 w-3"}),"Add Custom Date Range"]}),n&&(0,a.jsxs)("div",{className:"space-y-3 rounded-lg border border-border bg-card p-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(em,{htmlFor:"from",className:"text-xs",children:"From"}),(0,a.jsx)(el,{id:"from",type:"date",value:l,onChange:e=>c(e.target.value),className:"h-8 text-xs lg:text-[0.65rem] md:text-[0.65rem] pr-12 lg:pr-8"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(em,{htmlFor:"to",className:"text-xs",children:"To"}),(0,a.jsx)(el,{id:"to",type:"date",value:d,onChange:e=>m(e.target.value),className:"h-8 text-xs lg:text-[0.65rem] md:text-[0.65rem] pr-12 lg:pr-8"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(em,{htmlFor:"label",className:"text-xs",children:"Label (optional)"}),(0,a.jsx)(el,{id:"label",type:"text",placeholder:"e.g., Q1 2024",value:u,onChange:e=>h(e.target.value),className:"h-8 text-xs"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(f,{size:"sm",onClick:()=>{if(!l||!d)return void D.oR.error("Please select both start and end dates");if(new Date(l)>new Date(d))return void D.oR.error("Start date must be before end date");let e={id:"custom-".concat(Date.now()),from:l,to:d,label:u||"".concat(l," to ").concat(d)},a=[...t.savedCustomRanges||[],e];s({...t,dateRange:"Custom",customDateRange:e,savedCustomRanges:a}),o(!1),c(""),m(""),h(""),D.oR.success("Custom date range added")},disabled:!l||!d,className:"flex-1 text-xs",children:"Add Range"}),(0,a.jsx)(f,{variant:"outline",size:"sm",onClick:()=>{o(!1),c(""),m(""),h("")},className:"flex-1 text-xs",children:"Cancel"})]})]})]})};var ex=s(24033),ep=s(86651),ef=s(82286);let eg=ef.bL,ey=ef.l9,ev=r.forwardRef((e,t)=>{let{className:s,align:r="center",sideOffset:n=4,...o}=e;return(0,a.jsx)(ef.ZL,{children:(0,a.jsx)(ef.UC,{ref:t,align:r,sideOffset:n,className:(0,x.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",s),...o})})});function eb(e){let{options:t,selected:s,onChange:n,placeholder:o="Select..."}=e,[l,c]=r.useState(!1),[d,m]=r.useState(""),u=t.filter(e=>e.label.toLowerCase().includes(d.toLowerCase())),h=s.map(e=>{var s;return null==(s=t.find(t=>t.value===e))?void 0:s.label}).filter(Boolean);return(0,a.jsxs)(eg,{open:l,onOpenChange:c,children:[(0,a.jsx)(ey,{asChild:!0,children:(0,a.jsxs)(f,{variant:"outline",role:"combobox","aria-expanded":l,className:"w-full justify-between text-xs font-normal h-9",children:[(0,a.jsx)("div",{className:"flex flex-1 items-center gap-1 overflow-hidden",children:s.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"truncate",children:1===s.length?h[0]:"".concat(s.length," selected")}),s.length>0&&(0,a.jsx)("div",{className:"ml-1 h-4 w-4 flex items-center justify-center hover:bg-muted rounded cursor-pointer",onClick:e=>{e.stopPropagation(),n([])},children:(0,a.jsx)(i.A,{className:"h-3 w-3"})})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:o})}),(0,a.jsx)(ex.A,{className:"ml-2 h-3 w-3 shrink-0 opacity-50"})]})}),(0,a.jsxs)(ev,{className:"w-full p-0",align:"start",children:[(0,a.jsxs)("div",{className:"flex items-center border-b px-3 pb-2 pt-2",children:[(0,a.jsx)(ep.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(el,{placeholder:"Search...",value:d,onChange:e=>m(e.target.value),className:"h-8 border-0 p-0 text-xs focus-visible:ring-0"})]}),(0,a.jsx)("div",{className:"max-h-[200px] overflow-auto p-1",children:0===u.length?(0,a.jsx)("div",{className:"py-6 text-center text-xs text-muted-foreground",children:"No results found."}):u.map(e=>{let t=s.includes(e.value);return(0,a.jsxs)("button",{onClick:()=>{var t;return t=e.value,void n(s.includes(t)?s.filter(e=>e!==t):[...s,t])},className:(0,x.cn)("relative flex w-full cursor-pointer items-center rounded-sm px-2 py-1.5 text-xs outline-none transition-colors hover:bg-muted",t&&"bg-muted"),children:[(0,a.jsx)("div",{className:(0,x.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",t?"bg-primary text-primary-foreground":"opacity-50"),children:t&&(0,a.jsx)(z.A,{className:"h-3 w-3"})}),(0,a.jsx)("span",{className:"flex-1 text-left",children:e.label})]},e.value)})})]})]})}ev.displayName=ef.UC.displayName;var ej=s(22454);let eN={survey_names:["Q1 2024 Medical Survey - Oncology Focus","Q4 2023 Medical Survey - Cardiology Insights","Q3 2023 Medical Survey - Neurology Trends","Oncology Organic Insight US - Treatment Patterns","Oncology Organic Insight EU/UK - Clinical Practices","REGN Company Sponsored Studies - Myeloma Research","Adjuvant Practice Patterns Feedback Initiative - Moh's H&N Surgeons","HBCHONC - 2024 - NSCLC Treatment Guidelines"],questions:["What is your primary treatment approach for advanced NSCLC patients?","How do you assess treatment response in myeloma patients?","What factors influence your choice of adjuvant therapy?","How has your prescribing pattern changed in the last 12 months?","What are the main barriers to implementing new treatment protocols?","How do you evaluate patient quality of life during treatment?","What role does biomarker testing play in your treatment decisions?","How do you manage treatment-related adverse events?","What is your experience with combination therapies?","How do you determine optimal treatment duration?","What are your preferred first-line treatment options?","How do you approach treatment in elderly patients?","What is your experience with CAR-T cell therapy?","How do you manage treatment resistance?","What role does genomic testing play in your practice?"],countries:["United States","United Kingdom","Germany","France","Italy","Spain","Canada","Australia","Japan","Netherlands","Belgium","Switzerland","Sweden","Denmark","Norway"],regions:["North America","Europe","Asia Pacific","Latin America","Middle East"],territories:["Northeast US","Southeast US","Midwest US","Southwest US","West Coast US","Western Europe","Eastern Europe","Northern Europe","Southern Europe","Central Europe","Scandinavia"],msl_names:["Dr. Sarah Johnson","Dr. Michael Chen","Dr. Emily Rodriguez","Dr. David Thompson","Dr. Lisa Wang","Dr. James Miller","Dr. Maria Garcia","Dr. Robert Taylor","Dr. Jennifer Lee","Dr. Mark Anderson","Dr. Rachel Kim","Dr. Thomas Wilson"],account_names:["Mayo Clinic","Johns Hopkins Hospital","MD Anderson Cancer Center","Memorial Sloan Kettering","Cleveland Clinic","Mass General Brigham","UCSF Medical Center","Cedars-Sinai","Mount Sinai Health System","Dana-Farber Cancer Institute","Fred Hutchinson Cancer Center"],titles:["Medical Oncologist","Hematologist","Radiation Oncologist","Surgical Oncologist","Clinical Researcher","Department Head","Associate Professor","Senior Consultant","Research Director","Chief of Oncology","Clinical Director"]},ew=[{id:1,survey_name:"Q1 2024 Medical Survey - Oncology Focus",question:"What is your primary treatment approach for advanced NSCLC patients?",response:"Combination immunotherapy with chemotherapy as first-line treatment",country_geo_id:"United States",territory:"Northeast US",region:"North America",msl_name:"Dr. Sarah Johnson",account_name:"Mayo Clinic",title:"Medical Oncologist",date_submitted:"2024-03-15",respondent_id:"R001"},{id:2,survey_name:"REGN Company Sponsored Studies - Myeloma Research",question:"How do you assess treatment response in myeloma patients?",response:"Regular monitoring of M-protein levels combined with imaging studies",country_geo_id:"United Kingdom",territory:"Western Europe",region:"Europe",msl_name:"Dr. Michael Chen",account_name:"Johns Hopkins Hospital",title:"Hematologist",date_submitted:"2024-02-28",respondent_id:"R002"},{id:3,survey_name:"Oncology Organic Insight EU/UK - Clinical Practices",question:"What factors influence your choice of adjuvant therapy?",response:"Patient age, performance status, molecular markers, and comorbidities",country_geo_id:"Germany",territory:"Western Europe",region:"Europe",msl_name:"Dr. Emily Rodriguez",account_name:"MD Anderson Cancer Center",title:"Medical Oncologist",date_submitted:"2024-03-20",respondent_id:"R003"},{id:4,survey_name:"Adjuvant Practice Patterns Feedback Initiative - Moh's H&N Surgeons",question:"How has your prescribing pattern changed in the last 12 months?",response:"Increased use of targeted therapies and biomarker-guided treatment selection",country_geo_id:"France",territory:"Western Europe",region:"Europe",msl_name:"Dr. David Thompson",account_name:"Memorial Sloan Kettering",title:"Surgical Oncologist",date_submitted:"2024-03-10",respondent_id:"R004"},{id:5,survey_name:"HBCHONC - 2024 - NSCLC",question:"What are the main barriers to implementing new treatment protocols?",response:"Cost considerations, insurance approval delays, and patient access issues",country_geo_id:"Canada",territory:"North America",region:"North America",msl_name:"Dr. Lisa Wang",account_name:"Cleveland Clinic",title:"Clinical Researcher",date_submitted:"2024-03-25",respondent_id:"R005"},{id:6,survey_name:"Q4 2023 Medical Survey - Cardiology Insights",question:"How do you evaluate patient quality of life during treatment?",response:"Using standardized QoL questionnaires and regular patient assessments",country_geo_id:"Italy",territory:"Southern Europe",region:"Europe",msl_name:"Dr. James Miller",account_name:"Mass General Brigham",title:"Department Head",date_submitted:"2024-01-15",respondent_id:"R006"},{id:7,survey_name:"Oncology Organic Insight US - Treatment Patterns",question:"What role does biomarker testing play in your treatment decisions?",response:"Essential for treatment selection, particularly for targeted therapies",country_geo_id:"United States",territory:"West Coast US",region:"North America",msl_name:"Dr. Maria Garcia",account_name:"UCSF Medical Center",title:"Associate Professor",date_submitted:"2024-02-20",respondent_id:"R007"},{id:8,survey_name:"Q3 2023 Medical Survey - Neurology Trends",question:"How do you manage treatment-related adverse events?",response:"Proactive monitoring, dose modifications, and supportive care measures",country_geo_id:"Australia",territory:"Asia Pacific",region:"Asia Pacific",msl_name:"Dr. Robert Taylor",account_name:"Cedars-Sinai",title:"Senior Consultant",date_submitted:"2023-09-30",respondent_id:"R008"},{id:9,survey_name:"REGN Company Sponsored Studies - Myeloma Research",question:"What is your experience with combination therapies?",response:"Increasingly effective but requires careful patient selection and monitoring",country_geo_id:"Japan",territory:"Asia Pacific",region:"Asia Pacific",msl_name:"Dr. Jennifer Lee",account_name:"Mount Sinai Health System",title:"Research Director",date_submitted:"2024-03-05",respondent_id:"R009"},{id:10,survey_name:"Q1 2024 Medical Survey - Oncology Focus",question:"How do you determine optimal treatment duration?",response:"Based on response assessment, toxicity profile, and clinical guidelines",country_geo_id:"Netherlands",territory:"Western Europe",region:"Europe",msl_name:"Dr. Mark Anderson",account_name:"Dana-Farber Cancer Institute",title:"Chief of Oncology",date_submitted:"2024-03-18",respondent_id:"R010"},{id:11,survey_name:"Oncology Organic Insight EU/UK - Clinical Practices",question:"What are your preferred first-line treatment options?",response:"Immunotherapy-based combinations for eligible patients",country_geo_id:"Spain",territory:"Southern Europe",region:"Europe",msl_name:"Dr. Rachel Kim",account_name:"Fred Hutchinson Cancer Center",title:"Clinical Director",date_submitted:"2024-02-14",respondent_id:"R011"},{id:12,survey_name:"Adjuvant Practice Patterns Feedback Initiative - Moh's H&N Surgeons",question:"How do you approach treatment in elderly patients?",response:"Comprehensive geriatric assessment and modified treatment protocols",country_geo_id:"Belgium",territory:"Western Europe",region:"Europe",msl_name:"Dr. Thomas Wilson",account_name:"Mayo Clinic",title:"Medical Oncologist",date_submitted:"2024-03-12",respondent_id:"R012"}],eC=[...ew,...(e=>{let t=[],s=ew[0];for(let a=13;a<=e;a++)t.push({...s,id:a,respondent_id:"R".concat(String(a).padStart(3,"0")),date_submitted:new Date(2024,Math.floor(4*Math.random()),Math.floor(28*Math.random())+1).toISOString().split("T")[0],survey_name:ew[Math.floor(8*Math.random())].survey_name,question:ew[Math.floor(12*Math.random())].question,response:"Sample response ".concat(a," for survey data simulation")});return t})(50)],eS={status:"healthy",records:47832,last_updated:new Date().toISOString(),version:"1.0.0",endpoints:{surveys:"/api/surveys",filters:"/api/filters",health:"/api/health"}};class ek{async get(e,t){let s;if(!this.isEnabled)throw Error("Mock API is disabled");if(await (s=300+700*Math.random(),new Promise(e=>setTimeout(e,s))),.05>Math.random())throw Error("Simulated network error");switch(e){case"/api/health":return eS;case"/api/filters":return eN;case"/api/surveys":return this.getFilteredSurveys(t);case"/api/status":return{status:"active",mockEnabled:this.isEnabled,recordCount:eC.length,timestamp:new Date().toISOString()};default:throw Error("Mock endpoint not found: ".concat(e))}}getFilteredSurveys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[...eC];e.country_geo_id&&(t=t.filter(t=>t.country_geo_id.toLowerCase().includes(e.country_geo_id.toLowerCase()))),e.survey_name&&(t=t.filter(t=>t.survey_name.toLowerCase().includes(e.survey_name.toLowerCase()))),e.msl_name&&(t=t.filter(t=>t.msl_name.toLowerCase().includes(e.msl_name.toLowerCase()))),e.territory&&(t=t.filter(t=>t.territory.toLowerCase().includes(e.territory.toLowerCase()))),e.region&&(t=t.filter(t=>t.region.toLowerCase().includes(e.region.toLowerCase()))),e.response&&(t=t.filter(t=>t.response.toLowerCase().includes(e.response.toLowerCase()))),e.account_name&&(t=t.filter(t=>t.account_name.toLowerCase().includes(e.account_name.toLowerCase()))),e.title&&(t=t.filter(t=>t.title.toLowerCase().includes(e.title.toLowerCase())));let s=Math.max(1,parseInt(e.page)||1),a=Math.min(Math.max(1,parseInt(e.size)||20),100),r=(s-1)*a,n=r+a;return{surveys:t.slice(r,n),total:t.length,page:s,size:a,total_pages:Math.ceil(t.length/a),has_next:n<t.length,has_previous:s>1}}setEnabled(e){this.isEnabled=e}getStatus(){return{enabled:this.isEnabled,recordCount:eC.length,filterCount:Object.keys(eN).length}}constructor(){this.isEnabled="http://localhost:3000".includes("localhost")||!0}}let eR=new ek,eA=async(e,t)=>{try{return console.log("\uD83C\uDFAD Using mock API for ".concat(e)),await eR.get(e,t)}catch(e){console.warn("Mock API failed:",e)}try{let s="/api".concat(e.startsWith("/")?e:"/".concat(e));console.log("\uD83C\uDF10 Trying real API: ".concat(s));let a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",...null==t?void 0:t.headers},...t});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let r=await a.json();return console.log("✅ Real API success for ".concat(e)),r}catch(t){throw console.warn("❌ Real API failed for ".concat(e,":"),t),t}},eD=()=>(0,ej.I)({queryKey:["health"],queryFn:()=>eA("/api/health"),staleTime:3e5,retry:1}),e_=()=>(0,ej.I)({queryKey:["filter-options"],queryFn:()=>eA("/api/filters"),staleTime:6e5,retry:1});function eE(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,x.cn)("animate-pulse rounded-md bg-muted",t),...s})}function eM(e){let{variant:t="message"}=e;return"message"===t?(0,a.jsxs)("div",{className:"flex items-start gap-3 animate-fade-in",children:[(0,a.jsx)(eE,{className:"h-8 w-8 rounded-full flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(eE,{className:"h-4 w-24"}),(0,a.jsx)(eE,{className:"h-4 w-full"}),(0,a.jsx)(eE,{className:"h-4 w-3/4"}),(0,a.jsx)(eE,{className:"h-4 w-5/6"})]})]}):"filters"===t?(0,a.jsx)("div",{className:"space-y-4 p-4 animate-fade-in",children:[1,2,3,4].map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eE,{className:"h-5 w-32"}),(0,a.jsx)(eE,{className:"h-10 w-full"})]},e))}):"chat-history"===t?(0,a.jsx)("div",{className:"space-y-2 p-4 animate-fade-in",children:[1,2,3,4,5].map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eE,{className:"h-4 w-full"}),(0,a.jsx)(eE,{className:"h-3 w-2/3"})]},e))}):null}let eF=e=>{let{filters:t,setFilters:s}=e,{data:n,isLoading:o,error:i}=e_(),l=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.msl_names)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.msl_names]),c=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.titles)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.titles]);return((0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.departments)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.departments]),(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.user_types)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.user_types]),o)?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Team & Organization"}),(0,a.jsx)(eM,{})]}):i?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Team & Organization"}),(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Failed to load team filters"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Team & Organization"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"MSL (Medical Science Liaison)"}),(0,a.jsx)(eb,{options:l,selected:t.msl,onChange:e=>s(t=>({...t,msl:e})),placeholder:"Search MSL..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Title"}),(0,a.jsx)(eb,{options:c,selected:t.teamOrg,onChange:e=>s(t=>({...t,teamOrg:e})),placeholder:"Search title..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"National Director"}),(0,a.jsx)(eb,{options:c.filter(e=>e.label.toLowerCase().includes("director")),selected:t.nationalDirector,onChange:e=>s(t=>({...t,nationalDirector:e})),placeholder:"Search national director..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Regional Director"}),(0,a.jsx)(eb,{options:c.filter(e=>e.label.toLowerCase().includes("regional")),selected:t.regionalDirector,onChange:e=>s(t=>({...t,regionalDirector:e})),placeholder:"Search regional director..."})]})]})]})},eO=e=>{let{filters:t,setFilters:s}=e,{data:n,isLoading:o,error:i}=e_(),l=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.regions)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.regions]),c=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.countries)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.countries]),d=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.territories)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.territories]);return o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Geographic"}),(0,a.jsx)(eM,{})]}):i?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Geographic"}),(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Failed to load geographic filters"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Geographic"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Region"}),(0,a.jsx)(eb,{options:l,selected:t.region,onChange:e=>{s(t=>({...t,region:e}))},placeholder:"Search region..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Country"}),(0,a.jsx)(eb,{options:c,selected:t.country,onChange:e=>{s(t=>({...t,country:e}))},placeholder:"Search country..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Territory"}),(0,a.jsx)(eb,{options:d,selected:t.state,onChange:e=>{s(t=>({...t,state:e}))},placeholder:"Search territory..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Province"}),(0,a.jsx)(eb,{options:[],selected:t.province,onChange:e=>s(t=>({...t,province:e})),placeholder:"Search province..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"City"}),(0,a.jsx)(eb,{options:[],selected:t.city,onChange:e=>s(t=>({...t,city:e})),placeholder:"Search city..."})]})]})]})},eL=[{value:"oncology",label:"Oncology"},{value:"cardiology",label:"Cardiology"},{value:"neurology",label:"Neurology"},{value:"immunology",label:"Immunology"},{value:"endocrinology",label:"Endocrinology"}],eT=[{value:"tier-1",label:"Tier 1"},{value:"tier-2",label:"Tier 2"},{value:"tier-3",label:"Tier 3"}],ez=[{value:"academic",label:"Academic Medical Center"},{value:"community",label:"Community Hospital"},{value:"private",label:"Private Practice"},{value:"research",label:"Research Institution"}],eI=e=>{let{filters:t,setFilters:s}=e;return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground",children:"Healthcare Specific"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Specialty"}),(0,a.jsx)(eb,{options:eL,selected:t.specialty,onChange:e=>s({...t,specialty:e}),placeholder:"Search specialty..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Tier"}),(0,a.jsx)(eb,{options:eT,selected:t.tier,onChange:e=>s({...t,tier:e}),placeholder:"Search tier..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Practice Setting"}),(0,a.jsx)(eb,{options:ez,selected:t.practiceSetting,onChange:e=>s({...t,practiceSetting:e}),placeholder:"Search practice setting..."})]})]})]})},eP=[{value:"asco",label:"ASCO Annual Meeting"},{value:"ash",label:"ASH Annual Meeting"},{value:"esmo",label:"ESMO Congress"},{value:"acc",label:"ACC Scientific Sessions"}],eU=[{value:"oncology-board",label:"Oncology Advisory Board"},{value:"cardio-board",label:"Cardiovascular Advisory Board"},{value:"neuro-board",label:"Neurology Advisory Board"},{value:"immunology-board",label:"Immunology Advisory Board"}],eH=e=>{let{filters:t,setFilters:s}=e;return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground",children:"Event & Engagement"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Conferences"}),(0,a.jsx)(eb,{options:eP,selected:t.conferences,onChange:e=>s({...t,conferences:e}),placeholder:"Search conferences..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Advisory Boards"}),(0,a.jsx)(eb,{options:eU,selected:t.advisoryBoards,onChange:e=>s({...t,advisoryBoards:e}),placeholder:"Search advisory boards..."})]})]})]})},eq=e=>{let{filters:t,setFilters:s}=e,{data:n,isLoading:o,error:i}=e_(),l=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.survey_names)?void 0:e.map(e=>({value:e,label:e.length>50?"".concat(e.substring(0,50),"..."):e})))||[]},[null==n?void 0:n.survey_names]),c=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.questions)?void 0:e.map(e=>({value:e,label:e.length>60?"".concat(e.substring(0,60),"..."):e})))||[]},[null==n?void 0:n.questions]);return o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground",children:"Surveys"}),(0,a.jsx)(eM,{})]}):i?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground",children:"Surveys"}),(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Failed to load survey filters"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground",children:"Surveys"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Survey Name"}),(0,a.jsx)(eb,{options:l,selected:t.specificSurvey||[],onChange:e=>s(t=>({...t,specificSurvey:e})),placeholder:"Search surveys..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-xs font-medium text-sidebar-foreground",children:"Survey Question"}),(0,a.jsx)(eb,{options:c,selected:t.surveyQuestion||[],onChange:e=>s(t=>({...t,surveyQuestion:e})),placeholder:"Search questions..."})]})]})]})},eW=e=>{let{filters:t,setFilters:s}=e,{data:n,isLoading:o,error:i}=e_(),l=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.tumor_types)?void 0:e.map(e=>({value:e,label:e})))||[]},[null==n?void 0:n.tumor_types]),c=(0,r.useMemo)(()=>{var e;return(null==n||null==(e=n.tumor_types)?void 0:e.map(e=>({value:e,label:"".concat(e," Oncology")})))||[]},[null==n?void 0:n.tumor_types]);return o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Therapeutic Area"}),(0,a.jsx)(eM,{})]}):i?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Therapeutic Area"}),(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Failed to load therapeutic filters"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Therapeutic Area"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Tumor Type"}),(0,a.jsx)(eb,{options:l,selected:t.tumourType,onChange:e=>s(t=>({...t,tumourType:e})),placeholder:"Select tumor type..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Therapeutic Area"}),(0,a.jsx)(eb,{options:c,selected:t.therapeuticArea,onChange:e=>s(t=>({...t,therapeuticArea:e})),placeholder:"Select therapeutic area..."})]})]})]})},eB=Z.bL;Z.l9;let eJ=Z.ZL;Z.bm;let eK=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(Z.hJ,{ref:t,className:(0,x.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});eK.displayName=Z.hJ.displayName;let eG=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(eJ,{children:[(0,a.jsx)(eK,{}),(0,a.jsxs)(Z.UC,{ref:t,className:(0,x.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n,children:[r,(0,a.jsxs)(Z.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});eG.displayName=Z.UC.displayName;let eV=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,x.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};eV.displayName="DialogHeader";let eQ=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(Z.hE,{ref:t,className:(0,x.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});eQ.displayName=Z.hE.displayName;let eY=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(Z.VY,{ref:t,className:(0,x.cn)("text-sm text-muted-foreground",s),...r})});eY.displayName=Z.VY.displayName;var eZ=s(12677),eX=s(12108);let e$=eZ.bL;eZ.YJ;let e0=eZ.WT,e1=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(eZ.l9,{ref:t,className:(0,x.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[r,(0,a.jsx)(eZ.In,{asChild:!0,children:(0,a.jsx)(ex.A,{className:"h-4 w-4 opacity-50"})})]})});e1.displayName=eZ.l9.displayName;let e2=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eZ.PP,{ref:t,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(eX.A,{className:"h-4 w-4"})})});e2.displayName=eZ.PP.displayName;let e4=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eZ.wn,{ref:t,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(ex.A,{className:"h-4 w-4"})})});e4.displayName=eZ.wn.displayName;let e5=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...o}=e;return(0,a.jsx)(eZ.ZL,{children:(0,a.jsxs)(eZ.UC,{ref:t,className:(0,x.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...o,children:[(0,a.jsx)(e2,{}),(0,a.jsx)(eZ.LM,{className:(0,x.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(e4,{})]})})});e5.displayName=eZ.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eZ.JU,{ref:t,className:(0,x.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=eZ.JU.displayName;let e3=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(eZ.q7,{ref:t,className:(0,x.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eZ.VF,{children:(0,a.jsx)(z.A,{className:"h-4 w-4"})})}),(0,a.jsx)(eZ.p4,{children:r})]})});e3.displayName=eZ.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(eZ.wv,{ref:t,className:(0,x.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=eZ.wv.displayName;var e8=s(85710),e6=s(23327);let e9=e=>{let{open:t,onOpenChange:s,datasetCount:n,filters:i}=e,[l,c]=(0,r.useState)("csv"),d=(e,t)=>{let s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},m=Object.values(i).filter(e=>Array.isArray(e)?e.length>0:null!==e&&"Last 90 days"!==e).length;return(0,a.jsx)(eB,{open:t,onOpenChange:s,children:(0,a.jsxs)(eG,{className:"sm:max-w-[500px]",children:[(0,a.jsxs)(eV,{children:[(0,a.jsxs)(eQ,{className:"flex items-center gap-2",children:[(0,a.jsx)(e8.A,{className:"h-5 w-5"}),"Export Filtered Dataset"]}),(0,a.jsx)(eY,{children:"Download the current filtered dataset for external analysis"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-lg",children:[(0,a.jsx)(e8.A,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Dataset Size: ",(n/1e3).toFixed(1),"K records"]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Filters: ",m," active filters"]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Export Format"}),(0,a.jsxs)(e$,{value:l,onValueChange:c,children:[(0,a.jsx)(e1,{className:"w-full",children:(0,a.jsx)(e0,{placeholder:"Select export format"})}),(0,a.jsxs)(e5,{children:[(0,a.jsx)(e3,{value:"csv",className:"cursor-pointer data-[highlighted]:bg-muted data-[highlighted]:text-foreground focus:bg-muted focus:text-foreground",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e8.A,{className:"h-4 w-4"}),"CSV (Excel Compatible)"]})}),(0,a.jsx)(e3,{value:"json",className:"cursor-pointer data-[highlighted]:bg-muted data-[highlighted]:text-foreground focus:bg-muted focus:text-foreground",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(e8.A,{className:"h-4 w-4"}),"JSON (Raw Data)"]})})]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"File extension will be added automatically"})]}),(0,a.jsxs)("div",{className:"flex gap-3 p-3 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 rounded-lg",children:[(0,a.jsx)(e6.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Note:"}),(0,a.jsx)("p",{className:"text-blue-800 dark:text-blue-200",children:"This generates a mock dataset based on your current filters. In production, this would connect to your actual data source."})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)(f,{variant:"outline",onClick:()=>s(!1),className:"flex-1",children:"Cancel"}),(0,a.jsxs)(f,{onClick:()=>{try{let e=(()=>{let e=Object.values(i).filter(e=>Array.isArray(e)?e.length>0:null!==e&&"Last 90 days"!==e).length;return Array.from({length:Math.min(1e3,n)},(t,s)=>({id:"REC_".concat(String(s+1).padStart(6,"0")),timestamp:new Date(Date.now()-90*Math.random()*864e5).toISOString(),region:["North America","Europe","Asia Pacific","Latin America"][Math.floor(4*Math.random())],country:["United States","Canada","Germany","United Kingdom","France","Japan","Australia"][Math.floor(7*Math.random())],specialty:["Oncology","Cardiology","Neurology","Endocrinology","Rheumatology"][Math.floor(5*Math.random())],tier:["Tier ".concat(Math.floor(3*Math.random())+1)],practiceSetting:["Hospital","Private Practice","Academic Center","Research Institute"][Math.floor(4*Math.random())],therapeuticArea:["Oncology","Immunology","Rare Diseases","Neuroscience"][Math.floor(4*Math.random())],engagementScore:Math.floor(100*Math.random())+1,responseRate:(100*Math.random()).toFixed(1),surveyType:["Medical Survey","Advisory Board","Conference","Educational Event"][Math.floor(4*Math.random())],status:["Completed","In Progress","Scheduled","Cancelled"][Math.floor(4*Math.random())],notes:"Sample note for record ".concat(s+1," - filtered data with ").concat(e," active filters")}))})();"csv"===l?((e=>{if(0===e.length)return D.oR.error("No data to export");let t=Object.keys(e[0]),s=new Blob([[t.join(","),...e.map(e=>t.map(t=>{let s=e[t];return"string"==typeof s&&(s.includes(",")||s.includes('"')||s.includes("\n"))?'"'.concat(s.replace(/"/g,'""'),'"'):s}).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),a=new Date().toISOString().split("T")[0];d(s,"gfmi-dataset-".concat(a,".csv"))})(e),D.oR.success("Dataset exported as CSV (".concat(e.length," records)"))):"json"===l&&((e=>{if(0===e.length)return D.oR.error("No data to export");let t=new Blob([JSON.stringify({metadata:{exportDate:new Date().toISOString(),totalRecords:e.length,activeFilters:Object.entries(i).filter(e=>{let[t,s]=e;return Array.isArray(s)?s.length>0:null!==s&&"Last 90 days"!==s}).reduce((e,t)=>{let[s,a]=t;return{...e,[s]:a}},{}),datasetInfo:{totalAvailableRecords:n,appliedFiltersCount:Object.values(i).filter(e=>Array.isArray(e)?e.length>0:null!==e&&"Last 90 days"!==e).length}},data:e},null,2)],{type:"application/json;charset=utf-8;"}),s=new Date().toISOString().split("T")[0];d(t,"gfmi-dataset-".concat(s,".json"))})(e),D.oR.success("Dataset exported as JSON (".concat(e.length," records)"))),s(!1)}catch(e){console.error("Export failed:",e),D.oR.error("Export failed. Please try again.")}},className:"flex-1",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})]})})},e7=e=>{let{filters:t,setFilters:s,onClearAll:n,datasetCount:i}=e,[l,c]=(0,r.useState)(!1),[d,m]=(0,r.useState)(!1),u=Object.values(t).flat().filter(Boolean).length;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(X,{open:l,onOpenChange:c,children:[(0,a.jsx)($,{asChild:!0,children:(0,a.jsxs)(f,{variant:"outline",size:"icon",className:"lg:hidden relative","aria-label":"Open filters",children:[(0,a.jsx)(B.A,{className:"h-5 w-5"}),u>0&&(0,a.jsx)("span",{className:"absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-xs text-primary-foreground",children:u})]})}),(0,a.jsxs)(ea,{side:"left",className:"w-[85vw] sm:w-[400px] p-0",children:[(0,a.jsx)(er,{className:"border-b border-border px-6 py-4",children:(0,a.jsxs)(en,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Filters"}),(0,a.jsxs)(f,{variant:"ghost",size:"sm",onClick:()=>{n(),D.oR.info("All filters cleared")},className:"text-muted-foreground hover:text-foreground",children:[(0,a.jsx)(Q.A,{className:"mr-2 h-4 w-4"}),"Clear All"]})]})}),(0,a.jsx)(v,{className:"h-[calc(100vh-5rem)] custom-scrollbar",children:(0,a.jsxs)("div",{className:"space-y-6 p-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(f,{variant:"outline",className:"w-full justify-start",onClick:()=>{D.oR.success("Filters saved successfully")},children:[(0,a.jsx)(Y.A,{className:"mr-2 h-4 w-4"}),"Save Current Filters"]}),(0,a.jsxs)(f,{variant:"outline",className:"w-full justify-start",onClick:()=>{m(!0),c(!1)},children:[(0,a.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Export Dataset"]})]}),(0,a.jsx)(ei,{}),(0,a.jsx)(eh,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eF,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eO,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eI,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eW,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eH,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eq,{filters:t,setFilters:s})]})})]})]}),(0,a.jsx)(e9,{open:d,onOpenChange:m,datasetCount:i,filters:t,setFilters:s})]})};var te=s(98171);let tt=e=>{let{filters:t,setFilters:s,onClearAll:r,datasetCount:n,onNewChat:o,onToggleSidebar:i,sidebarOpen:l}=e,{setTheme:c,theme:d}=(0,V.D)(),m=e=>{document.body.classList.add("theme-transitioning"),c(e),setTimeout(()=>{document.body.classList.remove("theme-transitioning")},180)};return(0,a.jsx)("header",{className:"sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between px-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:i,className:"hidden md:flex text-muted-foreground hover:text-foreground hover:bg-muted transition-colors","aria-label":"Toggle sidebar",children:(0,a.jsx)(B.A,{className:"h-4 w-4"})}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)(e7,{filters:t,setFilters:s,onClearAll:r,datasetCount:n})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(J.A,{className:"h-6 w-6 text-primary"}),(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"GFMI Assistant"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(te.Bc,{children:(0,a.jsxs)(te.m_,{children:[(0,a.jsx)(te.k$,{asChild:!0,children:(0,a.jsx)(f,{variant:"ghost",size:"sm",onClick:o,className:"flex text-muted-foreground hover:text-foreground hover:bg-muted transition-colors border-0 shadow-none","aria-label":"New chat",children:(0,a.jsx)(J.A,{className:"h-4 w-4"})})}),(0,a.jsx)(te.ZI,{children:(0,a.jsx)("p",{children:"New Chat"})})]})})}),(0,a.jsxs)(P,{children:[(0,a.jsx)(U,{asChild:!0,children:(0,a.jsxs)(f,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground hover:bg-muted transition-colors border-0 shadow-none transition-all duration-150",children:[(0,a.jsx)(K.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,a.jsx)(G.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,a.jsxs)(H,{align:"end",className:"min-w-[120px]",children:[(0,a.jsx)(q,{onClick:()=>m("light"),className:"cursor-pointer text-sm",children:"Light"}),(0,a.jsx)(q,{onClick:()=>m("dark"),className:"cursor-pointer text-sm",children:"Dark"}),(0,a.jsx)(q,{onClick:()=>m("system"),className:"cursor-pointer text-sm",children:"System"})]})]})]})]})})},ts=e=>{let{onClearFilters:t,onExportConversation:s,onFocusInput:n,onOpenCommandPalette:o,onEscape:i}=e,l=(0,r.useRef)(null),c=(0,r.useRef)(0);return(0,r.useEffect)(()=>{let e=e=>{let a=e.target;if("INPUT"!==a.tagName&&"TEXTAREA"!==a.tagName&&"true"!==a.contentEditable){if("Escape"===e.key){null==i||i(),D.oR.info("Closed dialogs/modals",{duration:1500});return}if((e.metaKey||e.ctrlKey)&&"k"===e.key){e.preventDefault(),null==o||o(),D.oR.success("Command palette opened",{duration:2e3});return}if((e.metaKey||e.ctrlKey)&&"i"===e.key){e.preventDefault(),null==n||n(),D.oR.success("Input focused",{duration:1500});return}if((e.metaKey||e.ctrlKey)&&"e"===e.key){e.preventDefault();let t=JSON.parse(localStorage.getItem("gfmi-chat-history")||"[]");if(!t||0===t.length)return void D.oR.info("No conversation to export");let s=document.querySelector("[data-export-trigger]");if(s)s.click(),D.oR.success("Export options opened",{duration:2e3});else{let e=new CustomEvent("open-export-dropdown",{detail:{source:"keyboard-shortcut"}});window.dispatchEvent(e),D.oR.success("Export options opened",{duration:2e3})}return}if((e.metaKey||e.ctrlKey)&&e.shiftKey&&"C"===e.key){e.preventDefault(),null==t||t(),D.oR.success("Filters cleared",{duration:2e3});return}if("F1"===e.key||(e.metaKey||e.ctrlKey)&&"/"===e.key){e.preventDefault(),s();return}}},s=()=>{let e=Date.now();if(e-c.current<1e3)return;c.current=e,l.current&&D.oR.dismiss(l.current);let t="keyboard-shortcuts-".concat(e);l.current=t,D.oR.info((0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Keyboard Shortcuts"}),(0,a.jsxs)("ul",{className:"space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"⌘/Ctrl + K - Command palette"}),(0,a.jsx)("li",{children:"⌘/Ctrl + I - Focus chat input"}),(0,a.jsx)("li",{children:"⌘/Ctrl + E - Export conversation"}),(0,a.jsx)("li",{children:"⌘/Ctrl + Shift + C - Clear filters"}),(0,a.jsx)("li",{children:"Escape - Close dialogs"}),(0,a.jsx)("li",{children:"F1 or ⌘/Ctrl + / - Show help"})]})]}),{id:t,duration:5e3,style:{pointerEvents:"none"}})};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,s,n,o,i]),null};var ta=s(861),tr=s(21786),tn=s(66955),to=s(16485),ti=s(15870),tl=s(20908),tc=s(58734);function td(e){let{open:t,onOpenChange:s,onNewChat:n,onClearFilters:i,onExportChat:l,onToggleSidebar:c,onExportDataset:d,onOpenSettings:m,onOpenHelp:u,onCopyLastMessage:h,onOpenDatePicker:x,onResetFilters:p,onSaveConversation:f,onImportConversation:g}=e,[y,b]=(0,r.useState)(""),[j,w]=(0,r.useState)(0),{setTheme:C,theme:k}=(0,V.D)(),R=[{id:"new-chat",label:"New Chat",icon:(0,a.jsx)(eu.A,{size:18}),action:()=>{n(),s(!1)},keywords:["new","chat","conversation","start","create"],category:"Chat"},{id:"copy-last-message",label:"Copy Last Message",icon:(0,a.jsx)(S.A,{size:18}),action:()=>{h&&(h(),D.oR.success("Last message copied to clipboard")),s(!1)},keywords:["copy","last","message","clipboard"],category:"Chat"},{id:"save-conversation",label:"Save Conversation",icon:(0,a.jsx)(Y.A,{size:18}),action:()=>{f&&(f(),D.oR.success("Conversation saved")),s(!1)},keywords:["save","conversation","local","storage"],category:"Chat"},{id:"import-conversation",label:"Import Conversation",icon:(0,a.jsx)(tr.A,{size:18}),action:()=>{g&&g(),s(!1)},keywords:["import","conversation","load","restore"],category:"Chat"},{id:"toggle-sidebar",label:"Toggle Sidebar",icon:(0,a.jsx)(B.A,{size:18}),action:()=>{s(!1),setTimeout(()=>c(),100)},keywords:["sidebar","toggle","filters","history","panel"],category:"View"},{id:"toggle-theme",label:"dark"===k?"Switch to Light Mode":"Switch to Dark Mode",icon:"dark"===k?(0,a.jsx)(K.A,{size:18}):(0,a.jsx)(G.A,{size:18}),action:()=>{document.body.classList.add("theme-transitioning"),C("dark"===k?"light":"dark"),setTimeout(()=>{document.body.classList.remove("theme-transitioning")},180),s(!1)},keywords:["theme","dark","light","mode","appearance"],category:"View"},{id:"export-chat",label:"Export Conversation",icon:(0,a.jsx)(o.A,{size:18}),action:()=>{let e=JSON.parse(localStorage.getItem("gfmi-chat-history")||"[]");if(!e||0===e.length){D.oR.info("No conversation to export"),s(!1);return}s(!1),setTimeout(()=>{let e=new CustomEvent("open-export-dropdown",{detail:{source:"command-palette"}});window.dispatchEvent(e)},150)},keywords:["export","download","save","conversation","chat"],category:"Export"},{id:"export-dataset-csv",label:"Export Dataset (CSV)",icon:(0,a.jsx)(N.A,{size:18}),action:()=>{d&&(d("csv"),s(!1))},keywords:["export","dataset","csv","excel","data"],category:"Export"},{id:"export-dataset-json",label:"Export Dataset (JSON)",icon:(0,a.jsx)(e8.A,{size:18}),action:()=>{d&&(d("json"),s(!1))},keywords:["export","dataset","json","raw","data"],category:"Export"},{id:"clear-filters",label:"Clear All Filters",icon:(0,a.jsx)(tn.A,{size:18}),action:()=>{i(),D.oR.success("All filters cleared"),s(!1)},keywords:["clear","reset","filters","remove","all"],category:"Filters"},{id:"reset-filters",label:"Reset to Default Filters",icon:(0,a.jsx)(Q.A,{size:18}),action:()=>{p&&(p(),D.oR.success("Filters reset to default")),s(!1)},keywords:["reset","default","filters","restore"],category:"Filters"},{id:"open-date-picker",label:"Open Date Range Picker",icon:(0,a.jsx)(to.A,{size:18}),action:()=>{x&&x(),s(!1)},keywords:["date","range","picker","calendar","time"],category:"Filters"},{id:"open-settings",label:"Open Settings",icon:(0,a.jsx)(ti.A,{size:18}),action:()=>{m&&m(),s(!1)},keywords:["settings","preferences","config","options"],category:"Settings"},{id:"open-help",label:"Open Help & Documentation",icon:(0,a.jsx)(tl.A,{size:18}),action:()=>{u&&u(),s(!1)},keywords:["help","documentation","guide","support","docs"],category:"Help"},{id:"focus-search",label:"Focus Search Bar",icon:(0,a.jsx)(ep.A,{size:18}),action:()=>{s(!1),setTimeout(()=>{let e=document.querySelector('input[placeholder*="search"]');e&&e.focus()},100)},keywords:["focus","search","bar","input"],category:"Navigation"},{id:"open-recent-files",label:"Open Recent Files",icon:(0,a.jsx)(tc.A,{size:18}),action:()=>{D.oR.info("Recent files feature coming soon"),s(!1)},keywords:["recent","files","history","documents"],category:"Navigation"}],A=y?R.filter(e=>e.keywords.some(e=>e.toLowerCase().includes(y.toLowerCase()))||e.label.toLowerCase().includes(y.toLowerCase())):R,_=A.reduce((e,t)=>{let s=t.category||"Other";return e[s]||(e[s]=[]),e[s].push(t),e},{});(0,r.useEffect)(()=>{w(0)},[y]);let E=(0,r.useCallback)(e=>{if(t){if("Escape"===e.key)e.preventDefault(),s(!1);else if("ArrowDown"===e.key)e.preventDefault(),w(e=>e<A.length-1?e+1:e);else if("ArrowUp"===e.key)e.preventDefault(),w(e=>e>0?e-1:e);else if("Enter"===e.key)e.preventDefault(),A[j]&&A[j].action();else if("Tab"===e.key){e.preventDefault();let t=Object.keys(_);if(t.length>1){let e=A[j],s=(null==e?void 0:e.category)||"Other",a=(t.indexOf(s)+1)%t.length,r=t[a],n=A.findIndex(e=>e.category===r);-1!==n&&w(n)}}}},[t,j,A,_,s]);return(0,r.useEffect)(()=>(window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)),[E]),(0,a.jsx)(eB,{open:t,onOpenChange:s,children:(0,a.jsxs)(eG,{className:"max-w-2xl p-0 gap-0",children:[(0,a.jsx)(ta.s6,{children:(0,a.jsx)(eQ,{children:"Command Palette"})}),(0,a.jsxs)("div",{className:"flex items-center border-b px-4",children:[(0,a.jsx)(ep.A,{className:"mr-2 h-4 w-4 shrink-0 text-muted-foreground"}),(0,a.jsx)(el,{placeholder:"Type a command or search...",value:y,onChange:e=>b(e.target.value),className:"border-0 focus-visible:ring-0 focus-visible:ring-offset-0",autoFocus:!0,"aria-label":"Search commands"})]}),(0,a.jsx)(v,{className:"max-h-96 overflow-hidden",children:(0,a.jsx)("div",{className:"p-2",children:0===A.length?(0,a.jsx)("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"No commands found"}):Object.entries(_).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"mb-4",children:[Object.keys(_).length>1&&(0,a.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:t}),s.map((e,t)=>{let s=A.findIndex(t=>t.id===e.id);return(0,a.jsxs)("button",{onClick:e.action,className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm rounded-lg transition-colors text-left ".concat(j===s?"bg-primary text-primary-foreground":"hover:bg-muted"),"aria-selected":j===s,children:[e.icon,(0,a.jsx)("span",{className:"flex-1",children:e.label}),j===s&&(0,a.jsx)("span",{className:"text-xs opacity-60",children:"↵"})]},e.id)})]},t)})})}),(0,a.jsx)("div",{className:"border-t px-3 py-2 text-xs text-muted-foreground",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{children:"Navigate with ↑↓ keys • Tab to switch categories"}),(0,a.jsx)("div",{children:"Press Enter to select • Esc to close"})]})})]})})}let tm=function(){let{enabled:e=!0,sidebarSelectors:t=["[data-sidebar]",".sidebar","#sidebar",'[class*="sidebar"]','[class*="nav-sidebar"]',".main-navigation",".side-navigation"],collapseButtonSelectors:s=["[data-sidebar-toggle]","[data-sidebar-collapse]",".sidebar-toggle",".sidebar-collapse",'[aria-label*="collapse" i]','[aria-label*="toggle" i]','button[class*="sidebar"]','button[class*="collapse"]'],delay:a=100}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.useEffect)(()=>{if(!e)return;let r=setTimeout(()=>{(()=>{try{for(let e of s){let t=document.querySelector(e);if(t)return console.log("Found sidebar toggle button: ".concat(e)),t.click(),!0}for(let e of t){let t=document.querySelector(e);if(t&&t.offsetWidth>0){if(console.log("Found sidebar: ".concat(e)),t.classList.contains("expanded"))return t.classList.remove("expanded"),t.classList.add("collapsed"),!0;if(t.style.width&&"0px"!==t.style.width)return t.style.width="0px",t.style.overflow="hidden",!0;if("none"!==t.style.display)return t.dataset.originalDisplay=t.style.display||"block",t.style.display="none",!0}}if(document.querySelector(".offcanvas.show")){let e=document.querySelector('[data-bs-dismiss="offcanvas"]');return e&&e.click(),!0}if(document.querySelector(".ant-layout-sider:not(.ant-layout-sider-collapsed)")){let e=document.querySelector(".ant-layout-sider-trigger");return e&&e.click(),!0}return!1}catch(e){return console.warn("Error while trying to collapse sidebar:",e),!1}})()?console.log("Successfully collapsed external sidebar"):console.log("No external sidebar found to collapse")},a);return()=>clearTimeout(r)},[e,a])};var tu=s(76482);let th=()=>{let[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{if(localStorage.getItem("gfmi-shortcuts-hint-dismissed"))return void n(!0);let e=setTimeout(()=>{t(!0)},2e3);return()=>clearTimeout(e)},[]),(0,r.useEffect)(()=>{if(e&&!s){let e=setTimeout(()=>{t(!1)},8e3);return()=>clearTimeout(e)}},[e,s]),!e||s)?null:(0,a.jsx)("div",{className:"fixed bottom-4 right-4 z-50 bg-background border border-border rounded-lg shadow-lg p-4 max-w-sm transform transition-all duration-500 ".concat(e?"translate-y-0 opacity-100":"translate-y-4 opacity-0"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(tu.A,{className:"h-5 w-5 text-muted-foreground mt-0.5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm text-foreground font-medium",children:"Quick Tip"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Press"," ",(0,a.jsxs)("kbd",{className:"px-1.5 py-0.5 text-xs font-semibold text-foreground bg-muted border border-border rounded",children:[navigator.platform.includes("Mac")?"⌘":"Ctrl","+/"]})," ","to view all keyboard shortcuts"]})]}),(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted",onClick:()=>{t(!1),n(!0),localStorage.setItem("gfmi-shortcuts-hint-dismissed","true")},children:(0,a.jsx)(i.A,{className:"h-3 w-3"})})]})})},tx=e=>{let{filters:t,setFilters:s,onClearAll:n}=e,[i,l]=(0,r.useState)(!1);return(0,a.jsxs)("div",{className:"flex h-full w-full flex-col border-r border-border bg-sidebar-background",children:[(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Filters"}),(0,a.jsxs)(f,{variant:"ghost",size:"sm",onClick:()=>{n(),D.oR.info("All filters cleared")},className:"h-8 px-3",children:[(0,a.jsx)(Q.A,{className:"h-4 w-4 mr-2"}),"Clear All"]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 px-6 py-4 border-b border-border",children:[(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:()=>{D.oR.success("Filters saved successfully")},className:"w-full justify-start",children:[(0,a.jsx)(Y.A,{className:"h-4 w-4 mr-3"}),"Save Current Filters"]}),(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:()=>l(!0),className:"w-full justify-start",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-3"}),"Export Dataset"]})]}),(0,a.jsx)(v,{className:"flex-1",children:(0,a.jsx)("div",{className:"px-6 pb-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(eh,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eF,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eO,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eI,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eW,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eH,{filters:t,setFilters:s}),(0,a.jsx)(ei,{}),(0,a.jsx)(eq,{filters:t,setFilters:s})]})})})]}),(0,a.jsx)(e9,{open:i,onOpenChange:l,datasetCount:25e4,filters:t,setFilters:s})]})},tp=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,x.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});tp.displayName="Card";let tf=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,x.cn)("flex flex-col space-y-1.5 p-6",s),...r})});tf.displayName="CardHeader";let tg=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,x.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});tg.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,x.cn)("text-sm text-muted-foreground",s),...r})}).displayName="CardDescription";let ty=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,x.cn)("p-6 pt-0",s),...r})});ty.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,x.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter";let tv=(0,h.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function tb(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,x.cn)(tv({variant:s}),t),...r})}var tj=s(90368);let tN=e=>{let{filters:t}=e,[s,n]=(0,r.useState)(1),{data:o,isLoading:i,error:l}=(e=>(0,ej.I)({queryKey:["surveys",e],queryFn:async()=>{try{let t=await eA("/api/surveys",e);if(!t||"object"!=typeof t)throw Error("Invalid API response format");return{surveys:Array.isArray(t.surveys)?t.surveys:[],total:t.total||0,page:t.page||1,size:t.size||20,total_pages:t.total_pages||t.pages||0,has_next:t.has_next||!1,has_previous:t.has_previous||!1}}catch(e){throw console.error("Survey fetch error:",e),e}},enabled:!!e&&Object.keys(e).length>0,staleTime:12e4,retry:2,refetchOnWindowFocus:!1}))({...t,page:s,size:50});if(i)return(0,a.jsxs)(tp,{className:"h-full",children:[(0,a.jsx)(tf,{children:(0,a.jsx)(tg,{children:"Survey Data"})}),(0,a.jsx)(ty,{children:(0,a.jsx)(eM,{})})]});if(l)return(0,a.jsxs)(tp,{className:"h-full",children:[(0,a.jsx)(tf,{children:(0,a.jsx)(tg,{children:"Survey Data"})}),(0,a.jsx)(ty,{children:(0,a.jsx)("p",{className:"text-red-500",children:"Failed to load survey data"})})]});let{surveys:c=[],total:d=0,page:m=1,size:u=50,total_pages:h=0}=o||{};return(0,a.jsxs)(tp,{className:"h-full flex flex-col",children:[(0,a.jsxs)(tf,{className:"flex-shrink-0 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(tg,{children:"Survey Data"}),(0,a.jsxs)(tb,{variant:"secondary",children:[d," total records"]})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(s-1)*50+1,"-",Math.min(50*s,d)," of ",d," surveys"]})]}),(0,a.jsx)(ty,{className:"flex-1 p-0 overflow-hidden",children:(0,a.jsx)(v,{className:"h-full",children:(0,a.jsxs)("div",{className:"p-6 pb-20 space-y-4",children:[" ",0===c.length?(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No surveys found matching your filters."})}):c.map((e,t)=>(0,a.jsxs)("div",{className:"space-y-3 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[" ",(0,a.jsx)("h4",{className:"font-medium text-sm truncate",children:e.survey_name||"Unknown Survey"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:["ID: ",e.survey_qstn_resp_id]})]}),(0,a.jsxs)("div",{className:"flex gap-1 flex-wrap flex-shrink-0",children:[e.country_geo_id&&(0,a.jsx)(tb,{variant:"outline",className:"text-xs",children:e.country_geo_id}),e.response&&(0,a.jsx)(tb,{variant:"secondary",className:"text-xs",children:e.response})]})]}),e.question&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:[(0,a.jsx)("strong",{children:"Q:"})," ",e.question.length>150?"".concat(e.question.substring(0,150),"..."):e.question]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.msl_name&&(0,a.jsxs)("div",{className:"truncate",children:[(0,a.jsx)("span",{className:"font-medium",children:"MSL:"})," ",(0,a.jsx)("span",{className:"text-muted-foreground",children:e.msl_name})]}),e.account_name&&(0,a.jsxs)("div",{className:"truncate",children:[(0,a.jsx)("span",{className:"font-medium",children:"Account:"})," ",(0,a.jsx)("span",{className:"text-muted-foreground",children:e.account_name})]}),e.title&&(0,a.jsxs)("div",{className:"truncate",children:[(0,a.jsx)("span",{className:"font-medium",children:"Title:"})," ",(0,a.jsx)("span",{className:"text-muted-foreground",children:e.title})]}),e.territory&&(0,a.jsxs)("div",{className:"truncate",children:[(0,a.jsx)("span",{className:"font-medium",children:"Territory:"})," ",(0,a.jsx)("span",{className:"text-muted-foreground",children:e.territory})]})]}),t<c.length-1&&(0,a.jsx)(ei,{className:"mt-4"})]},e.survey_qstn_resp_id||"survey-row-".concat(t)))]})})}),(0,a.jsx)("div",{className:"flex-shrink-0 border-t bg-muted/30",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 p-4",children:[(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:()=>{s>1&&n(s-1)},disabled:s<=1,children:[(0,a.jsx)(tj.A,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[Array.from({length:Math.min(5,h)},(e,t)=>{let r=t+1;return(0,a.jsx)(f,{variant:s===r?"default":"outline",size:"sm",onClick:()=>n(r),className:"w-8 h-8 p-0",children:r},r)}),h>5&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"..."})]}),(0,a.jsxs)(f,{variant:"outline",size:"sm",onClick:()=>{s<h&&n(s+1)},disabled:s>=h,children:["Next",(0,a.jsx)(T.A,{className:"h-4 w-4 ml-1"})]})]})})]})},tw=()=>{var e,t,s,r,n;let{data:o,error:i,isLoading:l}=eD(),{data:c,error:d,isLoading:m}=e_();return(0,a.jsxs)("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg mb-4",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"\uD83D\uDD27 API Debug Info"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Health Check:"}),l&&(0,a.jsx)("span",{className:"text-blue-500",children:" Loading..."}),i&&(0,a.jsxs)("span",{className:"text-red-500",children:[" Error: ",String(i)]}),o&&(0,a.jsxs)("span",{className:"text-green-500",children:["✅ Connected (",o.records?String(o.records):"unknown"," records)"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Filter Options:"}),m&&(0,a.jsx)("span",{className:"text-blue-500",children:" Loading..."}),d&&(0,a.jsxs)("span",{className:"text-red-500",children:[" Error: ",String(d)]}),c&&(0,a.jsxs)("span",{className:"text-green-500",children:["✅ Loaded (",(null==(e=c.countries)?void 0:e.length)||0," countries, ",(null==(t=c.msl_names)?void 0:t.length)||0," MSLs)"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"API Base URL:"})," ","http://localhost:3000"]}),c&&(0,a.jsxs)("details",{className:"mt-2",children:[(0,a.jsx)("summary",{className:"cursor-pointer font-medium",children:"\uD83D\uDCCA Raw Filter Data (Sample)"}),(0,a.jsxs)("div",{className:"mt-2 p-2 bg-white dark:bg-gray-900 rounded text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Countries:"})," ",JSON.stringify((null==(s=c.countries)?void 0:s.slice(0,3))||[])]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"MSL Names:"})," ",JSON.stringify((null==(r=c.msl_names)?void 0:r.slice(0,2))||[])]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Survey Names:"})," ",JSON.stringify((null==(n=c.survey_names)?void 0:n.slice(0,2))||[])]})]})]}),o&&(0,a.jsxs)("details",{className:"mt-2",children:[(0,a.jsx)("summary",{className:"cursor-pointer font-medium",children:"\uD83D\uDC9A Health Data"}),(0,a.jsxs)("div",{className:"mt-2 p-2 bg-white dark:bg-gray-900 rounded text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Status:"})," ",String(o.status||"unknown")]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Records:"})," ","number"==typeof o.records?o.records:"unknown"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Database:"})," ",String(o.database||"unknown")]})]})]})]})]})},tC=(0,r.memo)(e=>{let{datasetCount:t,filters:u}=e,[h,x]=O("gfmi-chat-history",[]),[p,y]=O("gfmi-draft-message",""),[b,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[C,S]=(0,r.useState)(!1),[k,R]=(0,r.useState)(null),[A,_]=(0,r.useState)(!1),[E,L]=(0,r.useState)([]),[T,z]=(0,r.useState)(!1),I=(0,r.useRef)(null),B=(0,r.useRef)(null),J=(0,r.useRef)(null),[K,G]=(0,r.useState)(!1),V=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{var t;(null==(t=e.detail)?void 0:t.source)==="command-palette"&&(G(!0),setTimeout(()=>{var e;null==(e=V.current)||e.focus()},100))};return window.addEventListener("open-export-dropdown",e),()=>{window.removeEventListener("open-export-dropdown",e)}},[]);let Q=["image/png","image/jpeg","image/jpg","image/gif","image/webp","image/svg+xml","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain","text/csv","application/json","application/xml","text/xml"];(0,r.useEffect)(()=>{(()=>{if(B.current){let e=B.current.querySelector("[data-radix-scroll-area-viewport]");e&&(e.scrollTop=e.scrollHeight)}})()},[h]),(0,r.useEffect)(()=>{h.some(e=>"string"==typeof e.timestamp)&&x(h.map(e=>({...e,timestamp:e.timestamp instanceof Date?e.timestamp:new Date(e.timestamp)})))},[h.length]);let Y=e=>Q.includes(e.type),Z=e=>e.size<=0xf00000,X=async e=>{try{if(e.type.startsWith("image/"))return new Promise(t=>{let s=new Image;s.onload=()=>t(!1),s.onerror=()=>t(!0),s.src=URL.createObjectURL(e)});if("text/plain"===e.type||"text/csv"===e.type)try{return await e.text(),!1}catch(e){return!0}return 0===e.size}catch(e){return!0}},$=async e=>{if(e.type.startsWith("image/"))return new Promise(t=>{let s=new FileReader;s.onload=e=>{var s;return t(null==(s=e.target)?void 0:s.result)},s.onerror=()=>t(void 0),s.readAsDataURL(e)})},ee=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]},et=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{format:"txt"};if(0===h.length)return void D.oR.error("No conversation to export");let t=new Date().toISOString().split("T")[0],s=e.filename||"gfmi-conversation-".concat(t);switch(e.format){case"txt":es(h,"".concat(s,".txt"));break;case"pdf":ea(h,"".concat(s,".pdf"));break;case"docx":er(h,"".concat(s,".docx"))}D.oR.success("Conversation exported as ".concat(e.format.toUpperCase()))},es=(e,t)=>{en(new Blob([e.map(e=>{let t="user"===e.role?"You":"GFMI Assistant",s=e.timestamp.toLocaleString(),a="[".concat(s,"] ").concat(t,":\n").concat(e.content,"\n");return e.citations&&e.citations.length>0&&(a+="\nSources:\n",e.citations.forEach((e,t)=>{a+="[".concat(t+1,"] ").concat(e.title,"\n    ").concat(e.url,"\n")})),a}).join("\n")],{type:"text/plain"}),t)},ea=(e,t)=>{Promise.all([s.e(33),s.e(930),s.e(241)]).then(s.bind(s,55172)).then(s=>{let{jsPDF:a}=s,r=new a({format:"a4",unit:"mm"}),n=r.internal.pageSize.getWidth(),o=r.internal.pageSize.getHeight(),i=n-30,l=15;e.forEach((t,s)=>{let a="user"===t.role?"You":"GFMI Assistant",c=t.timestamp.toLocaleString();r.setFontSize(10),r.setFont(void 0,"bold");let d="[".concat(c,"] ").concat(a,":");l+7>o-15&&(r.addPage(),l=15),r.text(d,15,l),l+=8,r.setFontSize(9),l=((e,t)=>{let s=t;return e.split("\n").forEach(e=>{if(""===e.trim()){s+=4;return}let t=(e=>{let t,s=[],a=0,r=/(\*\*.*?\*\*|\*.*?\*)/g,n=[];for(;null!==(t=r.exec(e));){let e=t[0];e.startsWith("**")&&e.endsWith("**")?n.push({start:t.index,end:t.index+e.length,text:e.slice(2,-2),type:"bold"}):e.startsWith("*")&&e.endsWith("*")&&!e.startsWith("**")&&n.push({start:t.index,end:t.index+e.length,text:e.slice(1,-1),type:"italic"})}if(n.sort((e,t)=>e.start-t.start),n.forEach(t=>{if(t.start>a){let r=e.slice(a,t.start);r&&s.push({text:r})}s.push({text:t.text,bold:"bold"===t.type||"both"===t.type,italic:"italic"===t.type||"both"===t.type}),a=t.end}),a<e.length){let t=e.slice(a);t&&s.push({text:t})}return 0===s.length&&s.push({text:e}),s})(e);s+7>o-15&&(r.addPage(),s=15);let a=15;t.forEach(e=>{e.bold&&e.italic?r.setFont(void 0,"bolditalic"):e.bold?r.setFont(void 0,"bold"):e.italic?r.setFont(void 0,"italic"):r.setFont(void 0,"normal");let t=r.splitTextToSize(e.text,i-(a-15));t.forEach((e,i)=>{if(s+6>o-15&&(r.addPage(),s=15,a=15),r.text(e,a,s),i<t.length-1)s+=6,a=15;else{let t=r.getTextWidth(e);(a+=t)>n-15&&(s+=6,a=15)}})}),s+=7}),s})(t.content,l),t.citations&&t.citations.length>0&&(l+=3,r.setFontSize(8),r.setFont(void 0,"italic"),l+5>o-15&&(r.addPage(),l=15),r.text("Sources:",15,l),l+=5,t.citations.forEach((e,t)=>{let s="[".concat(t+1,"] ").concat(e.title);r.splitTextToSize(s,i-5).forEach(e=>{l+5>o-15&&(r.addPage(),l=15),r.text(e,20,l),l+=4}),r.splitTextToSize(e.url,i-5).forEach(e=>{l+4>o-15&&(r.addPage(),l=15),r.text(e,20,l),l+=4})})),l+=8,s<e.length-1&&l>o-15-20&&(r.addPage(),l=15)}),r.save(t)}).catch(()=>{D.oR.error("PDF export failed. Please try again.")})},er=(e,t)=>{Promise.all([Promise.all([s.e(489),s.e(376)]).then(s.bind(s,67863)),s.e(97).then(s.t.bind(s,20097,23))]).then(s=>{let[{Document:a,Packer:r,Paragraph:n,TextRun:o,HeadingLevel:i},l]=s,c=[];e.forEach(e=>{let t="user"===e.role?"You":"GFMI Assistant",s=e.timestamp.toLocaleString();c.push(new n({children:[new o({text:"[".concat(s,"] ").concat(t,":"),bold:!0,size:22})],spacing:{before:200,after:100}})),e.content.split("\n").forEach(e=>{if(""===e.trim())c.push(new n({text:""}));else{let t=(e=>{let t,s=/\*\*(.*?)\*\*/g,a=/\*(.*?)\*/g,r=0,n=[];for(;null!==(t=s.exec(e));)t.index>r&&n.push({text:e.slice(r,t.index)}),n.push({text:t[1],bold:!0}),r=t.index+t[0].length;r<e.length&&n.push({text:e.slice(r)});let o=[];return n.forEach(e=>{if(e.bold)o.push(e);else{let t,s=0,r=e.text;for(;null!==(t=a.exec(r));)t.index>s&&o.push({text:r.slice(s,t.index)}),o.push({text:t[1],italic:!0}),s=t.index+t[0].length;s<r.length&&o.push({text:r.slice(s)})}}),o.length>0?o:[{text:e}]})(e);c.push(new n({children:t.map(e=>new o({text:e.text,bold:e.bold||!1,italics:e.italic||!1})),spacing:{after:100}}))}}),e.citations&&e.citations.length>0&&(c.push(new n({children:[new o({text:"Sources:",italics:!0,size:20})],spacing:{before:100,after:50}})),e.citations.forEach((e,t)=>{c.push(new n({children:[new o({text:"[".concat(t+1,"] ").concat(e.title),size:18})],spacing:{after:30}})),c.push(new n({children:[new o({text:"    ".concat(e.url),size:18,italics:!0})],spacing:{after:50}}))})),c.push(new n({text:""}))});let d=new a({sections:[{properties:{},children:c}]});r.toBlob(d).then(e=>{l.saveAs(e,t)})}).catch(()=>{D.oR.error("DOCX export failed. Please try again.")})},en=(e,t)=>{let s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)},eo=async e=>{let t=Array.from(e.target.files||[]);await ei(t),I.current&&(I.current.value="")},ei=async e=>{if(E.length+e.length>5)return void D.oR.error("Maximum ".concat(5," files allowed. Currently have ").concat(E.length," files."));let t=[];for(let s of e){if(!Y(s)){D.oR.error("".concat(s.name,": Unsupported file type. Please upload documents, images, or text files only."));continue}if(!Z(s)){D.oR.error("".concat(s.name,": File too large. Maximum size is ").concat(ee(0xf00000),"."));continue}if(await X(s)){D.oR.error("".concat(s.name,": File appears to be corrupted or empty."));continue}let e=Object.assign(s,{id:"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),isCorrupt:!1});s.type.startsWith("image/")&&(e.preview=await $(e)),t.push(e)}if(t.length>0){z(!0),await new Promise(e=>setTimeout(e,800));let e=[...E,...t];L(e),z(!1);let s=e.length;D.oR.success("".concat(t.length," file(s) added • Total: ").concat(s," file(s) attached"))}},el=async e=>{var t;let s=null==(t=e.clipboardData)?void 0:t.items;if(!s)return;let a=[];for(let e=0;e<s.length;e++){let t=s[e];if(-1!==t.type.indexOf("image")){let e=t.getAsFile();if(e){let s=new Date().toISOString().replace(/[:.]/g,"-"),r=t.type.split("/")||"png",n=new File([e],"pasted-image-".concat(s,".").concat(r),{type:e.type});a.push(n)}}}a.length>0&&await ei(a)};(0,r.useEffect)(()=>{if(N){let e=setTimeout(()=>{if(null==k?void 0:k.signal.aborted)return;let e=A?[{title:"Medical Affairs Best Practices 2024",url:"https://example.com/medical-affairs-guide"},{title:"Healthcare Provider Engagement Strategies",url:"https://example.com/provider-engagement"},{title:"Oncology Insights Report Q1 2024",url:"https://example.com/oncology-report"}]:void 0,s={id:"ai-".concat(Date.now()),role:"assistant",content:(e=>{let s=e.toLowerCase();return s.includes("trend")?"Based on your current dataset of ".concat((t/1e3).toFixed(1),"K records with ").concat(Object.values(u).flat().length," active filters, here are the key trends I've identified:\n\n1. **Geographic Distribution**: Most activity is concentrated in North America and Europe\n2. **HCP Engagement**: Tier 1 and Tier 2 healthcare providers show highest engagement rates\n3. **Therapeutic Areas**: Oncology programs demonstrate strongest performance metrics\n4. **Seasonal Patterns**: Q3 and Q4 typically show increased conference and advisory board activity\n\nWould you like me to dive deeper into any specific trend?"):s.includes("summarize")?"Here's a summary of your filtered dataset:\n\n**Dataset Overview:**\n- Total Records: ".concat((t/1e3).toFixed(1),"K medical survey responses\n- Active Filters: ").concat(Object.values(u).flat().length,"\n- Date Range: ").concat(u.dateRange,"\n\n**Key Findings:**\n- High engagement rates across Tier 1 healthcare providers\n- Strong performance in oncology therapeutic areas\n- Increasing trend in advisory board participation\n- Geographic concentration in North America and Europe\n\nThe data suggests consistent growth in medical affairs engagement with opportunities for expansion in underrepresented regions."):"I've analyzed your question about \"".concat(e,'" using the current filtered dataset of ').concat((t/1e3).toFixed(1),"K records.\n\nBased on the applied filters and the medical affairs data, I can provide insights on:\n- Engagement patterns across your selected geographic regions\n- Performance metrics for the specified healthcare provider tiers\n- Trends in the selected therapeutic areas\n- Conference and advisory board participation rates\n\nCould you provide more specific details about what aspect you'd like me to focus on?")})(N),timestamp:new Date,citations:e,webSearchUsed:A};x(e=>[...e,s]),j(!1),S(!1),w(null),R(null)},1500);return()=>clearTimeout(e)}},[N,k,A]);let ec=async()=>{if(!p.trim()&&0===E.length)return;if(p.length>1e4)return void D.oR.error("Message too long! Maximum ".concat(1e4," characters allowed (current: ").concat(p.length,")"));let e=p.split("\n").length;if(e>100)return void D.oR.error("Message too long! Maximum ".concat(100," lines allowed (current: ").concat(e,")"));let t=p.trim(),s=[...E],a={id:"user-".concat(Date.now()),role:"user",content:t,timestamp:new Date,files:s.length>0?s:void 0,webSearchUsed:A};x(e=>[...e,a]),y(""),L([]),j(!0),S(!0),R(new AbortController),w(t)};return(0,a.jsx)("div",{className:"flex h-full flex-col bg-background",children:(0,a.jsxs)("div",{className:"flex h-full flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(n.A,{className:"h-5 w-5 text-primary"}),(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"GFMI Assistant"})]}),h.length>0&&(0,a.jsxs)(P,{open:K,onOpenChange:G,children:[(0,a.jsx)(U,{asChild:!0,children:(0,a.jsxs)(f,{ref:V,variant:"outline",size:"sm",className:"gap-2",children:[(0,a.jsx)(o.A,{className:"h-4 w-4"}),"Export Chat"]})}),(0,a.jsxs)(H,{align:"end",children:[(0,a.jsx)(q,{onClick:()=>et({format:"txt"}),className:"cursor-pointer text-sm",children:"Export as TXT"}),(0,a.jsx)(q,{onClick:()=>et({format:"pdf"}),className:"cursor-pointer text-sm",children:"Export as PDF"}),(0,a.jsx)(q,{onClick:()=>et({format:"docx"}),className:"cursor-pointer text-sm",children:"Export as DOCX"})]})]})]}),(0,a.jsx)(v,{ref:B,className:"flex-1 px-4 md:px-6",children:0===h.length?(0,a.jsx)(F,{datasetCount:t,onSuggestedQuestion:e=>{y(e)}}):(0,a.jsxs)("div",{className:"space-y-6 py-6 max-w-4xl mx-auto",children:[h.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(M,{message:e}),t<h.length-1&&(0,a.jsx)("div",{className:"h-px bg-border/30 mx-8 my-6"})]},e.id)),b&&(0,a.jsx)(W,{})]})}),(0,a.jsxs)("div",{className:"border-t border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 p-4 md:p-6",children:[(E.length>0||T)&&(0,a.jsxs)("div",{className:"mb-4 flex flex-wrap gap-2",children:[E.map(e=>(0,a.jsxs)("div",{className:"group relative flex items-center gap-2 rounded-lg bg-muted px-3 py-2 text-sm border border-border",children:[e.preview&&(0,a.jsx)("img",{src:e.preview,alt:e.name,className:"h-8 w-8 rounded object-cover"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"truncate max-w-32",children:e.name}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:ee(e.size)})]}),(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{var t;return t=e.id,void(L(E.filter(e=>e.id!==t)),D.oR.info("File removed"))},children:(0,a.jsx)(i.A,{className:"h-3 w-3"})})]},e.id)),T&&(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-muted px-3 py-2 text-sm",children:[(0,a.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}),"Uploading..."]})]}),(0,a.jsxs)("div",{className:"relative rounded-2xl border border-border bg-background shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsx)("input",{ref:I,type:"file",multiple:!0,accept:Q.join(","),onChange:eo,className:"hidden"}),(0,a.jsx)(f,{variant:"ghost",size:"sm",className:"absolute left-3 top-1/2 -translate-y-1/2 h-8 w-8 p-0 hover:bg-muted z-10",onClick:()=>{var e;return null==(e=I.current)?void 0:e.click()},disabled:E.length>=5,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})}),(0,a.jsx)(g,{ref:J,value:p,onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),ec())},onPaste:el,placeholder:"Ask a question about your filtered data... (Paste images with Ctrl+V)",className:"min-h-[52px] max-h-32 pl-12 pr-24   py-3 border-0 bg-transparent resize-none focus-visible:ring-0 focus-visible:ring-offset-0 scrollbar-thin",style:{lineHeight:"1.5"},"aria-label":"Chat input"}),(0,a.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[(0,a.jsx)(f,{variant:A?"default":"ghost",size:"sm",onClick:()=>{_(!A),D.oR.info(A?"Web search disabled":"Web search enabled")},className:"h-8 w-8 p-0",title:A?"Disable web search":"Enable web search",children:(0,a.jsx)(c.A,{className:"h-4 w-4 ".concat(A?"":"opacity-60")})}),C?(0,a.jsx)(f,{size:"sm",onClick:()=>{k&&(k.abort(),R(null)),j(!1),S(!1),w(null),D.oR.info("Response generation stopped")},className:"h-8 w-8 p-0 bg-destructive hover:bg-destructive/90",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})}):(0,a.jsx)(f,{size:"sm",onClick:ec,disabled:!p.trim()||b||T,className:"h-8 w-8 p-0",children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2 px-2",children:[(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Press Enter to send, Shift+Enter for new line • Max ",5," files"]}),p.length>0&&(0,a.jsxs)("span",{className:"text-xs ".concat(p.length>9e3?"text-destructive":"text-muted-foreground"),children:[p.length,"/",1e4]})]})]})]})})}),tS=()=>{let{data:e,error:t}=eD(),[s,n]=(0,r.useState)({dateRange:"Last 90 days",customDateRange:null,teamOrg:[],nationalDirector:[],regionalDirector:[],msl:[],region:[],country:[],state:[],province:[],city:[],specialty:[],tier:[],practiceSetting:[],conferences:[],advisoryBoards:[],specificSurvey:[],surveyQuestion:[],therapeuticArea:[],tumourType:[]}),o=(0,r.useMemo)(()=>({country_geo_id:s.country[0],territory:s.state[0],region:s.region[0],msl_name:s.msl[0],survey_name:s.specificSurvey[0],response:s.tumourType[0],account_name:void 0,title:s.teamOrg[0],page:1,size:50}),[s]);r.useEffect(()=>{t?D.oR.error("API connection failed. Check if your backend is running."):e&&D.oR.success("Connected to API - ".concat(e.records," records available"))},[e,t]);let[i]=(0,r.useState)(25e4),[l,c]=(0,r.useState)(0),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!0),[x,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)("csv"),[y,v]=(0,r.useState)(!1);tm({enabled:!0,delay:200,sidebarSelectors:[".sidebar","[data-sidebar]","#sidebar"],collapseButtonSelectors:[".sidebar-toggle","[data-sidebar-toggle]"]});let b=()=>{n({dateRange:"Last 90 days",customDateRange:null,teamOrg:[],nationalDirector:[],regionalDirector:[],msl:[],region:[],country:[],state:[],province:[],city:[],specialty:[],tier:[],practiceSetting:[],conferences:[],advisoryBoards:[],specificSurvey:[],surveyQuestion:[],therapeuticArea:[],tumourType:[]})},j=()=>{localStorage.removeItem("gfmi-chat-history"),localStorage.removeItem("gfmi-draft-message"),c(e=>e+1)},N=()=>{let e=new CustomEvent("export-chat");window.dispatchEvent(e)},[w,C]=(0,r.useState)(!0);return(0,a.jsxs)(V.N,{defaultTheme:"system",storageKey:"gfmi-theme",children:[(0,a.jsx)("div",{className:"fixed inset-0 overflow-hidden bg-background",children:(0,a.jsxs)("div",{className:"h-full w-full flex",children:[(0,a.jsx)("div",{className:"hidden md:block transition-all duration-300 ease-in-out flex-shrink-0 ".concat(u?"w-80":"w-0"," overflow-hidden"),children:u&&(0,a.jsx)("div",{className:"h-full w-80 overflow-hidden",children:(0,a.jsx)(tx,{filters:s,setFilters:n,onClearAll:b})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex flex-col overflow-hidden",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(tt,{filters:s,setFilters:n,onClearAll:b,datasetCount:i,onNewChat:j,onToggleSidebar:()=>h(!u),sidebarOpen:u})}),(0,a.jsx)("div",{className:"border-b px-4 py-2 bg-muted-foreground",children:(0,a.jsx)("button",{className:"text-sm font-medium",onClick:()=>C(e=>!e),children:w?"Hide API Debugger":"Show API Debugger"})}),w&&(0,a.jsx)(tw,{}),(0,a.jsxs)("div",{className:"flex-shrink-0 p-2 border-b",children:[(0,a.jsx)("button",{onClick:()=>v(!y),className:"px-3 py-1 text-sm bg-primary text-primary-foreground rounded",children:y?"Show Chat":"Show Survey Data"}),(0,a.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:e?"✅ API Connected (".concat(e.records," records)"):"❌ API Disconnected"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:y?(0,a.jsx)("div",{className:"h-full p-4",children:(0,a.jsx)(tN,{filters:o})}):(0,a.jsx)(tC,{datasetCount:i,filters:s},l)})]})]})}),(0,a.jsx)(ts,{onClearFilters:b,onExportConversation:N,onFocusInput:()=>{let e=document.querySelector('textarea[aria-label="Chat input"]');null==e||e.focus()},onOpenCommandPalette:()=>m(!0),onEscape:()=>m(!1)}),(0,a.jsx)(td,{open:d,onOpenChange:m,onNewChat:j,onClearFilters:b,onExportChat:N,onToggleSidebar:()=>{h(!u)},onExportDataset:e=>{g(e),p(!0)},onCopyLastMessage:()=>{let e=JSON.parse(localStorage.getItem("gfmi-chat-history")||"[]");if(e.length>0){let t=e.slice().reverse().find(e=>"assistant"===e.role);if(t)return navigator.clipboard.writeText(t.content),!0}return!1},onSaveConversation:()=>{let e=JSON.parse(localStorage.getItem("gfmi-chat-history")||"[]");if(0===e.length)return void D.oR.info("No conversation to save");let t=new Date().toISOString(),a={id:"conv_".concat(Date.now()),timestamp:t,messages:e,filters:s,title:"Conversation ".concat(new Date().toLocaleDateString())},r=JSON.parse(localStorage.getItem("gfmi-saved-conversations")||"[]");r.push(a),localStorage.setItem("gfmi-saved-conversations",JSON.stringify(r)),D.oR.success("Conversation saved successfully")},onImportConversation:()=>{let e=JSON.parse(localStorage.getItem("gfmi-saved-conversations")||"[]");if(0===e.length)return void D.oR.info("No saved conversations found");let t=e[e.length-1];localStorage.setItem("gfmi-chat-history",JSON.stringify(t.messages)),n(t.filters),c(e=>e+1),D.oR.success("Loaded conversation from ".concat(new Date(t.timestamp).toLocaleDateString()))},onOpenSettings:()=>{D.oR.info("Settings panel coming soon")},onOpenHelp:()=>{D.oR.info("Help documentation coming soon")},onOpenDatePicker:()=>{D.oR.info("Date range picker coming soon")},onResetFilters:()=>{n({dateRange:"Last 90 days",customDateRange:null,teamOrg:[],nationalDirector:[],regionalDirector:[],msl:[],region:[],country:[],state:[],province:[],city:[],specialty:[],tier:[],practiceSetting:[],conferences:[],advisoryBoards:[],specificSurvey:[],surveyQuestion:[],therapeuticArea:[],tumourType:[]}),D.oR.success("Filters reset to default")}}),(0,a.jsx)(e9,{open:x,onOpenChange:p,datasetCount:i,filters:s,setFilters:n}),(0,a.jsx)(th,{})]})}},50691:(e,t,s)=>{"use strict";s.d(t,{D:()=>l,N:()=>i});var a=s(95155),r=s(12115);let n={theme:"system",setTheme:()=>null},o=(0,r.createContext)(n);function i(e){let{children:t,defaultTheme:s="system",storageKey:i="vite-ui-theme",...l}=e,[c,d]=(0,r.useState)(s),[m,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{try{let e=localStorage.getItem(i);e&&d(e)}catch(e){console.warn("localStorage not available, using default theme")}u(!0)},[i]);let h=e=>{let t=window.document.documentElement;if(t.classList.remove("light","dark"),"system"===e){let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";t.classList.add(e)}else t.classList.add(e)};return((0,r.useEffect)(()=>{m&&h(c)},[c,m]),m)?(0,a.jsx)(o.Provider,{...l,value:{theme:c,setTheme:e=>{try{localStorage.setItem(i,e)}catch(e){console.warn("Failed to save theme to localStorage")}"undefined"!=typeof document&&"startViewTransition"in document?document.startViewTransition(()=>{d(e),h(e)}):d(e)}},children:t}):(0,a.jsx)(o.Provider,{value:n,children:t})}let l=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},62513:(e,t,s)=>{Promise.resolve().then(s.bind(s,41218))},64269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var a=s(2821),r=s(75889);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},98171:(e,t,s)=>{"use strict";s.d(t,{Bc:()=>i,ZI:()=>d,k$:()=>c,m_:()=>l});var a=s(95155),r=s(12115),n=s(47520),o=s(64269);let i=n.Kq,l=n.bL,c=n.l9,d=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,a.jsx)(n.UC,{ref:t,sideOffset:r,className:(0,o.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})});d.displayName=n.UC.displayName}},e=>{e.O(0,[443,321,441,255,358],()=>e(e.s=62513)),_N_E=e.O()}]);